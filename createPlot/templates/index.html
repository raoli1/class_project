<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>My First Dashboard</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js"></script>
    <style>
    #button{
        font-family: Optima, sans-serif;
        background-color: white;
        color: #00326e;
        border: 2px solid #00326e; 
    }
    #home{
        text-align: center;
        padding: 2%;
    }
    </style>
</head>
<body>
<div class="container">
    <div class="row">
        
        <div class='chart' id='theMap'>
            <script>

                var g = {{usamap | safe }};
                Plotly.plot('theMap', g, {});

            </script>
        </div>
        <div class="col-xs-3">
            <label> Choose which state you would like to look into details:</label>
            <select class="form-control" id ='first_cat'>
                <option value="National">National</option>
                {% for line in codelst %}
                    <option value={{line}}>{{line}}</option>
                {% endfor %}
            </select>
        </div>
        <div class="col-md-6">
            <div class="chart" id="bargraph">
                <script>
                    var graphs = {{plot | safe}};
                    Plotly.plot('bargraph',graphs,{});
                </script>
            </div>
        </div>
    </div>
</div>
<div id="home">
<form action="/api/connectToApi" method="get">
<input id="button" type="submit" value="Back To Home">
</form>
</div>
<script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
<script>
    $('#first_cat').on('change',function(){

    $.ajax({
        url: "/api/createPlot",
        type: "GET",
        contentType: 'application/json;charset=UTF-8',
        data: {
            'selected': document.getElementById('first_cat').value

        },
        dataType:"json",
        success: function (data) {
            Plotly.newPlot('bargraph', data );
        }
    });
})

</script>
</body>
</html>